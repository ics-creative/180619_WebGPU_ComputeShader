!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="js/",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"create",function(){return M}),n.d(r,"clone",function(){return m}),n.d(r,"copy",function(){return _}),n.d(r,"fromValues",function(){return b}),n.d(r,"set",function(){return g}),n.d(r,"identity",function(){return y}),n.d(r,"transpose",function(){return v}),n.d(r,"invert",function(){return D}),n.d(r,"adjoint",function(){return w}),n.d(r,"determinant",function(){return S}),n.d(r,"multiply",function(){return x}),n.d(r,"translate",function(){return E}),n.d(r,"scale",function(){return A}),n.d(r,"rotate",function(){return P}),n.d(r,"rotateX",function(){return O}),n.d(r,"rotateY",function(){return T}),n.d(r,"rotateZ",function(){return U}),n.d(r,"fromTranslation",function(){return C}),n.d(r,"fromScaling",function(){return R}),n.d(r,"fromRotation",function(){return L}),n.d(r,"fromXRotation",function(){return H}),n.d(r,"fromYRotation",function(){return N}),n.d(r,"fromZRotation",function(){return I}),n.d(r,"fromRotationTranslation",function(){return B}),n.d(r,"fromQuat2",function(){return V}),n.d(r,"getTranslation",function(){return q}),n.d(r,"getScaling",function(){return j}),n.d(r,"getRotation",function(){return X}),n.d(r,"fromRotationTranslationScale",function(){return F}),n.d(r,"fromRotationTranslationScaleOrigin",function(){return G}),n.d(r,"fromQuat",function(){return W}),n.d(r,"frustum",function(){return k}),n.d(r,"perspective",function(){return Y}),n.d(r,"perspectiveFromFieldOfView",function(){return Q}),n.d(r,"ortho",function(){return z}),n.d(r,"lookAt",function(){return Z}),n.d(r,"targetTo",function(){return K}),n.d(r,"str",function(){return J}),n.d(r,"frob",function(){return $}),n.d(r,"add",function(){return tt}),n.d(r,"subtract",function(){return et}),n.d(r,"multiplyScalar",function(){return nt}),n.d(r,"multiplyScalarAndAdd",function(){return rt}),n.d(r,"exactEquals",function(){return it}),n.d(r,"equals",function(){return ot}),n.d(r,"mul",function(){return at}),n.d(r,"sub",function(){return ut});var i={};n.r(i),n.d(i,"create",function(){return st}),n.d(i,"clone",function(){return ct}),n.d(i,"length",function(){return ht}),n.d(i,"fromValues",function(){return ft}),n.d(i,"copy",function(){return dt}),n.d(i,"set",function(){return lt}),n.d(i,"add",function(){return pt}),n.d(i,"subtract",function(){return Mt}),n.d(i,"multiply",function(){return mt}),n.d(i,"divide",function(){return _t}),n.d(i,"ceil",function(){return bt}),n.d(i,"floor",function(){return gt}),n.d(i,"min",function(){return yt}),n.d(i,"max",function(){return vt}),n.d(i,"round",function(){return Dt}),n.d(i,"scale",function(){return wt}),n.d(i,"scaleAndAdd",function(){return St}),n.d(i,"distance",function(){return xt}),n.d(i,"squaredDistance",function(){return Et}),n.d(i,"squaredLength",function(){return At}),n.d(i,"negate",function(){return Pt}),n.d(i,"inverse",function(){return Ot}),n.d(i,"normalize",function(){return Tt}),n.d(i,"dot",function(){return Ut}),n.d(i,"cross",function(){return Ct}),n.d(i,"lerp",function(){return Rt}),n.d(i,"hermite",function(){return Lt}),n.d(i,"bezier",function(){return Ht}),n.d(i,"random",function(){return Nt}),n.d(i,"transformMat4",function(){return It}),n.d(i,"transformMat3",function(){return Bt}),n.d(i,"transformQuat",function(){return Vt}),n.d(i,"rotateX",function(){return qt}),n.d(i,"rotateY",function(){return jt}),n.d(i,"rotateZ",function(){return Xt}),n.d(i,"angle",function(){return Ft}),n.d(i,"str",function(){return Gt}),n.d(i,"exactEquals",function(){return Wt}),n.d(i,"equals",function(){return kt}),n.d(i,"sub",function(){return Yt}),n.d(i,"mul",function(){return Qt}),n.d(i,"div",function(){return zt}),n.d(i,"dist",function(){return Zt}),n.d(i,"sqrDist",function(){return Kt}),n.d(i,"len",function(){return Jt}),n.d(i,"sqrLen",function(){return $t}),n.d(i,"forEach",function(){return te});var o,a=function(){function t(){}return Object.defineProperty(t.prototype,"bufferData",{get:function(){return this._bufferData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferDataLength",{get:function(){return this._bufferDataLength},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this._buffer},enumerable:!0,configurable:!0}),t.prototype.createBuffer=function(t){this._buffer=t.createBuffer(new Float32Array(this._bufferDataLength)),this._bufferData=new Float32Array(this._buffer.contents)},t.prototype._copyData=function(t,e,n){for(var r=0;r<n;r++)this._bufferData[e+r]=t[r]},t}(),u=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(){var n=t.call(this)||this;return n._bufferDataLength=e.BUFFER_LENGTH,n}return u(e,t),Object.defineProperty(e.prototype,"mvpMatrix",{get:function(){return this._bufferData.subarray(0,16)},set:function(t){this._copyData(t,0,16)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numLines",{get:function(){return this._bufferData[16]},set:function(t){this._bufferData[16]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return this._bufferData[17]},set:function(t){this._bufferData[17]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortCompleteTime",{get:function(){return this._bufferData[18]},set:function(t){this._bufferData[18]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertexUniformBuffer",{get:function(){return this._vertexUniformBuffer},enumerable:!0,configurable:!0}),e.BUFFER_LENGTH=19,e}(a),c=function(){function t(){}return Object.defineProperty(t.prototype,"numAttributes",{get:function(){return this._numAttributes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferData",{get:function(){return this._bufferData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertexBuffer",{get:function(){return this._vertexBuffer},enumerable:!0,configurable:!0}),t.prototype.createBuffer=function(t){this._vertexBuffer=t.createBuffer(this._bufferData)},t}(),h=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(t){function e(e,n,r){var i=t.call(this)||this,o=e+1,a=n/2,u=e/2,s=n/e;i._numAttributes=3,i._numVertices=4*o;for(var c=new Float32Array(3*i._numVertices),h=0;h<o;h++){var f=6*h,d=(h-u)*s;c[f]=-a,c[f+1]=r,c[f+2]=d,c[f+3]=a,c[f+4]=r,c[f+5]=d;var l=6*(h+o);c[l]=d,c[l+1]=r,c[l+2]=-a,c[l+3]=d,c[l+4]=r,c[l+5]=a}return i._bufferData=new Float32Array(c),i}return h(e,t),e}(c);const d=1e-6;let l="undefined"!=typeof Float32Array?Float32Array:Array;const p=Math.random;Math.PI;function M(){let t=new l(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function m(t){let e=new l(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function _(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function b(t,e,n,r,i,o,a,u,s,c,h,f,d,p,M,m){let _=new l(16);return _[0]=t,_[1]=e,_[2]=n,_[3]=r,_[4]=i,_[5]=o,_[6]=a,_[7]=u,_[8]=s,_[9]=c,_[10]=h,_[11]=f,_[12]=d,_[13]=p,_[14]=M,_[15]=m,_}function g(t,e,n,r,i,o,a,u,s,c,h,f,d,l,p,M,m){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t[9]=h,t[10]=f,t[11]=d,t[12]=l,t[13]=p,t[14]=M,t[15]=m,t}function y(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function v(t,e){if(t===e){let n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function D(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],h=e[8],f=e[9],d=e[10],l=e[11],p=e[12],M=e[13],m=e[14],_=e[15],b=n*u-r*a,g=n*s-i*a,y=n*c-o*a,v=r*s-i*u,D=r*c-o*u,w=i*c-o*s,S=h*M-f*p,x=h*m-d*p,E=h*_-l*p,A=f*m-d*M,P=f*_-l*M,O=d*_-l*m,T=b*O-g*P+y*A+v*E-D*x+w*S;return T?(T=1/T,t[0]=(u*O-s*P+c*A)*T,t[1]=(i*P-r*O-o*A)*T,t[2]=(M*w-m*D+_*v)*T,t[3]=(d*D-f*w-l*v)*T,t[4]=(s*E-a*O-c*x)*T,t[5]=(n*O-i*E+o*x)*T,t[6]=(m*y-p*w-_*g)*T,t[7]=(h*w-d*y+l*g)*T,t[8]=(a*P-u*E+c*S)*T,t[9]=(r*E-n*P-o*S)*T,t[10]=(p*D-M*y+_*b)*T,t[11]=(f*y-h*D-l*b)*T,t[12]=(u*x-a*A-s*S)*T,t[13]=(n*A-r*x+i*S)*T,t[14]=(M*g-p*v-m*b)*T,t[15]=(h*v-f*g+d*b)*T,t):null}function w(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],h=e[8],f=e[9],d=e[10],l=e[11],p=e[12],M=e[13],m=e[14],_=e[15];return t[0]=u*(d*_-l*m)-f*(s*_-c*m)+M*(s*l-c*d),t[1]=-(r*(d*_-l*m)-f*(i*_-o*m)+M*(i*l-o*d)),t[2]=r*(s*_-c*m)-u*(i*_-o*m)+M*(i*c-o*s),t[3]=-(r*(s*l-c*d)-u*(i*l-o*d)+f*(i*c-o*s)),t[4]=-(a*(d*_-l*m)-h*(s*_-c*m)+p*(s*l-c*d)),t[5]=n*(d*_-l*m)-h*(i*_-o*m)+p*(i*l-o*d),t[6]=-(n*(s*_-c*m)-a*(i*_-o*m)+p*(i*c-o*s)),t[7]=n*(s*l-c*d)-a*(i*l-o*d)+h*(i*c-o*s),t[8]=a*(f*_-l*M)-h*(u*_-c*M)+p*(u*l-c*f),t[9]=-(n*(f*_-l*M)-h*(r*_-o*M)+p*(r*l-o*f)),t[10]=n*(u*_-c*M)-a*(r*_-o*M)+p*(r*c-o*u),t[11]=-(n*(u*l-c*f)-a*(r*l-o*f)+h*(r*c-o*u)),t[12]=-(a*(f*m-d*M)-h*(u*m-s*M)+p*(u*d-s*f)),t[13]=n*(f*m-d*M)-h*(r*m-i*M)+p*(r*d-i*f),t[14]=-(n*(u*m-s*M)-a*(r*m-i*M)+p*(r*s-i*u)),t[15]=n*(u*d-s*f)-a*(r*d-i*f)+h*(r*s-i*u),t}function S(t){let e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8],h=t[9],f=t[10],d=t[11],l=t[12],p=t[13],M=t[14],m=t[15];return(e*a-n*o)*(f*m-d*M)-(e*u-r*o)*(h*m-d*p)+(e*s-i*o)*(h*M-f*p)+(n*u-r*a)*(c*m-d*l)-(n*s-i*a)*(c*M-f*l)+(r*s-i*u)*(c*p-h*l)}function x(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],h=e[7],f=e[8],d=e[9],l=e[10],p=e[11],M=e[12],m=e[13],_=e[14],b=e[15],g=n[0],y=n[1],v=n[2],D=n[3];return t[0]=g*r+y*u+v*f+D*M,t[1]=g*i+y*s+v*d+D*m,t[2]=g*o+y*c+v*l+D*_,t[3]=g*a+y*h+v*p+D*b,g=n[4],y=n[5],v=n[6],D=n[7],t[4]=g*r+y*u+v*f+D*M,t[5]=g*i+y*s+v*d+D*m,t[6]=g*o+y*c+v*l+D*_,t[7]=g*a+y*h+v*p+D*b,g=n[8],y=n[9],v=n[10],D=n[11],t[8]=g*r+y*u+v*f+D*M,t[9]=g*i+y*s+v*d+D*m,t[10]=g*o+y*c+v*l+D*_,t[11]=g*a+y*h+v*p+D*b,g=n[12],y=n[13],v=n[14],D=n[15],t[12]=g*r+y*u+v*f+D*M,t[13]=g*i+y*s+v*d+D*m,t[14]=g*o+y*c+v*l+D*_,t[15]=g*a+y*h+v*p+D*b,t}function E(t,e,n){let r,i,o,a,u,s,c,h,f,d,l,p,M=n[0],m=n[1],_=n[2];return e===t?(t[12]=e[0]*M+e[4]*m+e[8]*_+e[12],t[13]=e[1]*M+e[5]*m+e[9]*_+e[13],t[14]=e[2]*M+e[6]*m+e[10]*_+e[14],t[15]=e[3]*M+e[7]*m+e[11]*_+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],h=e[7],f=e[8],d=e[9],l=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=h,t[8]=f,t[9]=d,t[10]=l,t[11]=p,t[12]=r*M+u*m+f*_+e[12],t[13]=i*M+s*m+d*_+e[13],t[14]=o*M+c*m+l*_+e[14],t[15]=a*M+h*m+p*_+e[15]),t}function A(t,e,n){let r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function P(t,e,n,r){let i,o,a,u,s,c,h,f,l,p,M,m,_,b,g,y,v,D,w,S,x,E,A,P,O=r[0],T=r[1],U=r[2],C=Math.sqrt(O*O+T*T+U*U);return C<d?null:(O*=C=1/C,T*=C,U*=C,i=Math.sin(n),a=1-(o=Math.cos(n)),u=e[0],s=e[1],c=e[2],h=e[3],f=e[4],l=e[5],p=e[6],M=e[7],m=e[8],_=e[9],b=e[10],g=e[11],y=O*O*a+o,v=T*O*a+U*i,D=U*O*a-T*i,w=O*T*a-U*i,S=T*T*a+o,x=U*T*a+O*i,E=O*U*a+T*i,A=T*U*a-O*i,P=U*U*a+o,t[0]=u*y+f*v+m*D,t[1]=s*y+l*v+_*D,t[2]=c*y+p*v+b*D,t[3]=h*y+M*v+g*D,t[4]=u*w+f*S+m*x,t[5]=s*w+l*S+_*x,t[6]=c*w+p*S+b*x,t[7]=h*w+M*S+g*x,t[8]=u*E+f*A+m*P,t[9]=s*E+l*A+_*P,t[10]=c*E+p*A+b*P,t[11]=h*E+M*A+g*P,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function O(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],u=e[6],s=e[7],c=e[8],h=e[9],f=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+h*r,t[6]=u*i+f*r,t[7]=s*i+d*r,t[8]=c*i-o*r,t[9]=h*i-a*r,t[10]=f*i-u*r,t[11]=d*i-s*r,t}function T(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],s=e[3],c=e[8],h=e[9],f=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-h*r,t[2]=u*i-f*r,t[3]=s*i-d*r,t[8]=o*r+c*i,t[9]=a*r+h*i,t[10]=u*r+f*i,t[11]=s*r+d*i,t}function U(t,e,n){let r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],s=e[3],c=e[4],h=e[5],f=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+h*r,t[2]=u*i+f*r,t[3]=s*i+d*r,t[4]=c*i-o*r,t[5]=h*i-a*r,t[6]=f*i-u*r,t[7]=d*i-s*r,t}function C(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function R(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function L(t,e,n){let r,i,o,a=n[0],u=n[1],s=n[2],c=Math.sqrt(a*a+u*u+s*s);return c<d?null:(a*=c=1/c,u*=c,s*=c,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=a*a*o+i,t[1]=u*a*o+s*r,t[2]=s*a*o-u*r,t[3]=0,t[4]=a*u*o-s*r,t[5]=u*u*o+i,t[6]=s*u*o+a*r,t[7]=0,t[8]=a*s*o+u*r,t[9]=u*s*o-a*r,t[10]=s*s*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function H(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function B(t,e,n){let r=e[0],i=e[1],o=e[2],a=e[3],u=r+r,s=i+i,c=o+o,h=r*u,f=r*s,d=r*c,l=i*s,p=i*c,M=o*c,m=a*u,_=a*s,b=a*c;return t[0]=1-(l+M),t[1]=f+b,t[2]=d-_,t[3]=0,t[4]=f-b,t[5]=1-(h+M),t[6]=p+m,t[7]=0,t[8]=d+_,t[9]=p-m,t[10]=1-(h+l),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function V(t,e){let n=new l(3),r=-e[0],i=-e[1],o=-e[2],a=e[3],u=e[4],s=e[5],c=e[6],h=e[7],f=r*r+i*i+o*o+a*a;return f>0?(n[0]=2*(u*a+h*r+s*o-c*i)/f,n[1]=2*(s*a+h*i+c*r-u*o)/f,n[2]=2*(c*a+h*o+u*i-s*r)/f):(n[0]=2*(u*a+h*r+s*o-c*i),n[1]=2*(s*a+h*i+c*r-u*o),n[2]=2*(c*a+h*o+u*i-s*r)),B(t,e,n),t}function q(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function j(t,e){let n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],u=e[6],s=e[8],c=e[9],h=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(o*o+a*a+u*u),t[2]=Math.sqrt(s*s+c*c+h*h),t}function X(t,e){let n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function F(t,e,n,r){let i=e[0],o=e[1],a=e[2],u=e[3],s=i+i,c=o+o,h=a+a,f=i*s,d=i*c,l=i*h,p=o*c,M=o*h,m=a*h,_=u*s,b=u*c,g=u*h,y=r[0],v=r[1],D=r[2];return t[0]=(1-(p+m))*y,t[1]=(d+g)*y,t[2]=(l-b)*y,t[3]=0,t[4]=(d-g)*v,t[5]=(1-(f+m))*v,t[6]=(M+_)*v,t[7]=0,t[8]=(l+b)*D,t[9]=(M-_)*D,t[10]=(1-(f+p))*D,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function G(t,e,n,r,i){let o=e[0],a=e[1],u=e[2],s=e[3],c=o+o,h=a+a,f=u+u,d=o*c,l=o*h,p=o*f,M=a*h,m=a*f,_=u*f,b=s*c,g=s*h,y=s*f,v=r[0],D=r[1],w=r[2],S=i[0],x=i[1],E=i[2],A=(1-(M+_))*v,P=(l+y)*v,O=(p-g)*v,T=(l-y)*D,U=(1-(d+_))*D,C=(m+b)*D,R=(p+g)*w,L=(m-b)*w,H=(1-(d+M))*w;return t[0]=A,t[1]=P,t[2]=O,t[3]=0,t[4]=T,t[5]=U,t[6]=C,t[7]=0,t[8]=R,t[9]=L,t[10]=H,t[11]=0,t[12]=n[0]+S-(A*S+T*x+R*E),t[13]=n[1]+x-(P*S+U*x+L*E),t[14]=n[2]+E-(O*S+C*x+H*E),t[15]=1,t}function W(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,u=r+r,s=i+i,c=n*a,h=r*a,f=r*u,d=i*a,l=i*u,p=i*s,M=o*a,m=o*u,_=o*s;return t[0]=1-f-p,t[1]=h+_,t[2]=d-m,t[3]=0,t[4]=h-_,t[5]=1-c-p,t[6]=l+M,t[7]=0,t[8]=d+m,t[9]=l-M,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function k(t,e,n,r,i,o,a){let u=1/(n-e),s=1/(i-r),c=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(i+r)*s,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function Y(t,e,n,r,i){let o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t}function Q(t,e,n,r){let i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(a+u),c=2/(i+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-u)*s*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function z(t,e,n,r,i,o,a){let u=1/(e-n),s=1/(r-i),c=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*u,t[13]=(i+r)*s,t[14]=(a+o)*c,t[15]=1,t}function Z(t,e,n,r){let i,o,a,u,s,c,h,f,l,p,M=e[0],m=e[1],_=e[2],b=r[0],g=r[1],v=r[2],D=n[0],w=n[1],S=n[2];return Math.abs(M-D)<d&&Math.abs(m-w)<d&&Math.abs(_-S)<d?y(t):(h=M-D,f=m-w,l=_-S,i=g*(l*=p=1/Math.sqrt(h*h+f*f+l*l))-v*(f*=p),o=v*(h*=p)-b*l,a=b*f-g*h,(p=Math.sqrt(i*i+o*o+a*a))?(i*=p=1/p,o*=p,a*=p):(i=0,o=0,a=0),u=f*a-l*o,s=l*i-h*a,c=h*o-f*i,(p=Math.sqrt(u*u+s*s+c*c))?(u*=p=1/p,s*=p,c*=p):(u=0,s=0,c=0),t[0]=i,t[1]=u,t[2]=h,t[3]=0,t[4]=o,t[5]=s,t[6]=f,t[7]=0,t[8]=a,t[9]=c,t[10]=l,t[11]=0,t[12]=-(i*M+o*m+a*_),t[13]=-(u*M+s*m+c*_),t[14]=-(h*M+f*m+l*_),t[15]=1,t)}function K(t,e,n,r){let i=e[0],o=e[1],a=e[2],u=r[0],s=r[1],c=r[2],h=i-n[0],f=o-n[1],d=a-n[2],l=h*h+f*f+d*d;l>0&&(h*=l=1/Math.sqrt(l),f*=l,d*=l);let p=s*d-c*f,M=c*h-u*d,m=u*f-s*h;return(l=p*p+M*M+m*m)>0&&(p*=l=1/Math.sqrt(l),M*=l,m*=l),t[0]=p,t[1]=M,t[2]=m,t[3]=0,t[4]=f*m-d*M,t[5]=d*p-h*m,t[6]=h*M-f*p,t[7]=0,t[8]=h,t[9]=f,t[10]=d,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function J(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function $(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function tt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function et(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function nt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function rt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function it(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ot(t,e){let n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],c=t[7],h=t[8],f=t[9],l=t[10],p=t[11],M=t[12],m=t[13],_=t[14],b=t[15],g=e[0],y=e[1],v=e[2],D=e[3],w=e[4],S=e[5],x=e[6],E=e[7],A=e[8],P=e[9],O=e[10],T=e[11],U=e[12],C=e[13],R=e[14],L=e[15];return Math.abs(n-g)<=d*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-y)<=d*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-v)<=d*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-D)<=d*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(a-w)<=d*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(u-S)<=d*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(s-x)<=d*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(c-E)<=d*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(h-A)<=d*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(f-P)<=d*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(l-O)<=d*Math.max(1,Math.abs(l),Math.abs(O))&&Math.abs(p-T)<=d*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(M-U)<=d*Math.max(1,Math.abs(M),Math.abs(U))&&Math.abs(m-C)<=d*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(_-R)<=d*Math.max(1,Math.abs(_),Math.abs(R))&&Math.abs(b-L)<=d*Math.max(1,Math.abs(b),Math.abs(L))}const at=x,ut=et;function st(){let t=new l(3);return t[0]=0,t[1]=0,t[2]=0,t}function ct(t){var e=new l(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ht(t){let e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function ft(t,e,n){let r=new l(3);return r[0]=t,r[1]=e,r[2]=n,r}function dt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function lt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function pt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Mt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function mt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function _t(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function bt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function gt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function yt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function vt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Dt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function wt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function St(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function xt(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function Et(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function At(t){let e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Pt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Ot(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Tt(t,e){let n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function Ut(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ct(t,e,n){let r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],s=n[2];return t[0]=i*s-o*u,t[1]=o*a-r*s,t[2]=r*u-i*a,t}function Rt(t,e,n,r){let i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function Lt(t,e,n,r,i,o){let a=o*o,u=a*(2*o-3)+1,s=a*(o-2)+o,c=a*(o-1),h=a*(3-2*o);return t[0]=e[0]*u+n[0]*s+r[0]*c+i[0]*h,t[1]=e[1]*u+n[1]*s+r[1]*c+i[1]*h,t[2]=e[2]*u+n[2]*s+r[2]*c+i[2]*h,t}function Ht(t,e,n,r,i,o){let a=1-o,u=a*a,s=o*o,c=u*a,h=3*o*u,f=3*s*a,d=s*o;return t[0]=e[0]*c+n[0]*h+r[0]*f+i[0]*d,t[1]=e[1]*c+n[1]*h+r[1]*f+i[1]*d,t[2]=e[2]*c+n[2]*h+r[2]*f+i[2]*d,t}function Nt(t,e){e=e||1;let n=2*p()*Math.PI,r=2*p()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function It(t,e,n){let r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function Bt(t,e,n){let r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function Vt(t,e,n){let r=n[0],i=n[1],o=n[2],a=n[3],u=e[0],s=e[1],c=e[2],h=i*c-o*s,f=o*u-r*c,d=r*s-i*u,l=i*d-o*f,p=o*h-r*d,M=r*f-i*h,m=2*a;return h*=m,f*=m,d*=m,l*=2,p*=2,M*=2,t[0]=u+h+l,t[1]=s+f+p,t[2]=c+d+M,t}function qt(t,e,n,r){let i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function jt(t,e,n,r){let i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Xt(t,e,n,r){let i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Ft(t,e){let n=ft(t[0],t[1],t[2]),r=ft(e[0],e[1],e[2]);Tt(n,n),Tt(r,r);let i=Ut(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Gt(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Wt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function kt(t,e){let n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],u=e[2];return Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))}const Yt=Mt,Qt=mt,zt=_t,Zt=xt,Kt=Et,Jt=ht,$t=At,te=function(){let t=st();return function(e,n,r,i,o,a){let u,s;for(n||(n=3),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}();!function(){let t=function(){let t=new l(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}()}();function ee(){let t=new l(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ne(t,e,n,r){let i,o,a,u,s,c=e[0],h=e[1],f=e[2],d=e[3],l=n[0],p=n[1],M=n[2],m=n[3];return(o=c*l+h*p+f*M+d*m)<0&&(o=-o,l=-l,p=-p,M=-M,m=-m),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),u=Math.sin((1-r)*i)/a,s=Math.sin(r*i)/a):(u=1-r,s=r),t[0]=u*c+s*l,t[1]=u*h+s*p,t[2]=u*f+s*M,t[3]=u*d+s*m,t}const re=function(t,e){let n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t};(function(){let t=st(),e=ft(1,0,0),n=ft(0,1,0)})(),function(){let t=ee(),e=ee()}(),function(){let t=function(){let t=new l(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}()}();!function(){let t=function(){let t=new l(2);return t[0]=0,t[1]=0,t}()}();var ie=function(){function t(t,e,n,o){this._cameraUP=i.fromValues(0,1,0),this._projectionMtx=r.identity(r.create()),this._cameraMtx=r.identity(r.create()),this._lookMtx=r.identity(r.create()),this.x=0,this.y=0,this.z=0,r.perspective(this._projectionMtx,t,e,n,o)}return t.prototype.getCameraMtx=function(){return this._cameraMtx},t.prototype.lookAt=function(t){r.identity(this._lookMtx),r.lookAt(this._lookMtx,i.fromValues(this.x,this.y,this.z),t,this._cameraUP),r.multiply(this._cameraMtx,this._projectionMtx,this._lookMtx)},t.DIRECTION=i.fromValues(0,0,1),t}(),oe=function(){function t(){}return t.KEY_DOWN="keydown",t}(),ae=function(){function t(){}return t.MOUSE_DOWN="mousedown",t.MOUSE_UP="mouseup",t.MOUSE_MOVE="mousemove",t.MOUSE_WHEEL="mousewheel",t.DOM_MOUSE_SCROLL="DOMMouseScroll",t}(),ue=function(){function t(){}return t.GESTURE_START="gesturestart",t.GESTURE_CHANGE="gesturechange",t.GESTURE_END="gestureend",t}(),se=function(){function t(){}return t.TOUCH_START="touchstart",t.TOUCH_MOVE="touchmove",t.TOUCH_END="touchend",t}(),ce=function(){function t(){}return t.UP=38,t.DOWN=40,t}(),he=function(){function t(t,e){this.radiusMin=1,this.radiusOffset=.1,this.gestureRadiusFactor=20,this.radius=2,this._theta=0,this._oldX=0,this._phi=90,this._oldY=0,this._currentTheta=0,this._currentPhi=90,this._camera=t,this._stage=e,this._target=i.fromValues(0,0,0),this.enable(),this._updateCamera()}return t.prototype.enable=function(){var t=this;document.addEventListener(oe.KEY_DOWN,function(e){t._keyHandler(e)}),document.addEventListener(ae.MOUSE_UP,function(e){t._upHandler(e)}),this._stage.addEventListener(ae.MOUSE_DOWN,function(e){t._downHandler(e)}),this._stage.addEventListener(ae.MOUSE_MOVE,function(e){t._moveHandler(e)}),this._stage.addEventListener(ae.MOUSE_WHEEL,function(e){t._wheelHandler(e)}),this._stage.addEventListener(ae.DOM_MOUSE_SCROLL,function(e){t._domMouseScrollHandler(e)}),"ontouchstart"in window&&(this._stage.addEventListener(se.TOUCH_START,function(e){t._touchStartHandler(e)}),this._stage.addEventListener(se.TOUCH_MOVE,function(e){t._touchMoveHandler(e)}),document.addEventListener(se.TOUCH_END,function(e){t._touchEndHandler(e)})),("ongesturestart"in window||"GestureEvent"in window)&&(this._stage.addEventListener(ue.GESTURE_START,function(e){t._gestureStartHandler(e)}),this._stage.addEventListener(ue.GESTURE_CHANGE,function(e){t._gestureChangeHandler(e)}),document.addEventListener(ue.GESTURE_END,function(e){t._gestureEndHandler(e)}))},t.prototype._keyHandler=function(t){switch(t.keyCode){case ce.UP:this.radius-=this.radiusOffset,this.radius<this.radiusMin&&(this.radius=this.radiusMin);break;case ce.DOWN:this.radius+=this.radiusOffset}},t.prototype._upHandler=function(t){this.isMouseDown=!1},t.prototype._downHandler=function(t){this.isMouseDown=!0;var e=t.target.getBoundingClientRect();this._oldX=t.clientX-e.left,this._oldY=t.clientY-e.top},t.prototype._wheelHandler=function(t){t.preventDefault(),t.wheelDelta>0?(this.radius-=this.radiusOffset,this.radius<this.radiusMin&&(this.radius=this.radiusMin)):this.radius+=this.radiusOffset},t.prototype._domMouseScrollHandler=function(t){t.preventDefault(),t.detail<0?(this.radius-=this.radiusOffset,this.radius<this.radiusMin&&(this.radius=this.radiusMin)):this.radius+=this.radiusOffset},t.prototype._moveHandler=function(t){if(this.isMouseDown){var e=t.target.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top;this.inputXY(n,r)}},t.prototype._touchStartHandler=function(t){if(t.preventDefault(),!this.isMouseDown){var e=t.changedTouches[0];this.isMouseDown=!0,this._identifier=e.identifier;var n=e.target;this._oldX=e.pageX-n.offsetLeft,this._oldY=e.pageY-n.offsetTop}},t.prototype._touchMoveHandler=function(t){if(t.preventDefault(),!this._isGestureChange)for(var e=t.changedTouches,n=e.length,r=0;r<n;r++){var i=e[r];if(i.identifier===this._identifier){var o=i.target,a=i.pageX-o.offsetLeft,u=i.pageY-o.offsetTop;this.inputXY(a,u);break}}},t.prototype._touchEndHandler=function(t){this.isMouseDown&&t.preventDefault(),this.isMouseDown=!1},t.prototype._gestureStartHandler=function(t){t.preventDefault(),t.stopImmediatePropagation(),this._isGestureChange=!0,this.isMouseDown=!0,this._oldRadius=this.radius},t.prototype._gestureChangeHandler=function(t){t.preventDefault(),t.stopImmediatePropagation(),this.radius=this._oldRadius+this.gestureRadiusFactor*this.radiusOffset*(1-t.scale),this.radius<this.radiusMin&&(this.radius=this.radiusMin)},t.prototype._gestureEndHandler=function(t){t.preventDefault(),t.stopImmediatePropagation(),this._isGestureChange=!1,this.isMouseDown=!1,this._identifier=-1},t.prototype.inputXY=function(t,e){this._theta-=.3*(t-this._oldX),this._oldX=t,this._phi-=.3*(e-this._oldY),this._oldY=e,this._phi<20?this._phi=20:this._phi>160&&(this._phi=160)},t.prototype._updateCamera=function(){var e=this._currentTheta*t.RAD,n=this._currentPhi*t.RAD,r=this.radius*Math.sin(n);this._camera.x=r*Math.sin(e)+this._target[0],this._camera.z=r*Math.cos(e)+this._target[2],this._camera.y=this.radius*Math.cos(n)+this._target[1],this._camera.lookAt(this._target)},t.prototype.upDate=function(t){void 0===t&&(t=.1),this._currentTheta+=(this._theta-this._currentTheta)*t,this._currentPhi+=(this._phi-this._currentPhi)*t,this._updateCamera()},t.prototype.rotate=function(t,e){this._theta+=t,this._phi+=e},t.prototype.set=function(t,e){this._theta=t,this._phi=e},t.RAD=Math.PI/180,t}();n.d(e,"Main",function(){return le});var fe=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,u)}s((r=r.apply(t,e||[])).next())})},de=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},le=function(){function t(){console.log(new Date),this.init()}return t.prototype.init=function(){return fe(this,void 0,void 0,function(){var e,n,r,i,o,a,u,c,h,d,l,p,M;return de(this,function(m){switch(m.label){case 0:return"WebGPURenderingContext"in window?(this.stats=new Stats,document.body.appendChild(this.stats.dom),this.canvas=document.getElementById("myCanvas"),this.canvas.width=t.CANVAS_WIDTH,this.canvas.height=t.CANVAS_HEIGHT,this.gpu=this.canvas.getContext("webgpu"),this.commandQueue=this.gpu.createCommandQueue(),this.maxThreadNum=/iP(hone|(o|a)d)/.test(navigator.userAgent)?t.MAX_THREAD_NUM_iOS:t.MAX_THREAD_NUM_macOS,[4,fetch("shader/defaultShader.metal").then(function(t){return t.text()})]):(document.body.className="error",[2]);case 1:return e=(e=m.sent()).replace("#define MAX_THREAD_NUM 512","#define MAX_THREAD_NUM "+this.maxThreadNum),n=this.gpu.createLibrary(e),r=n.functionWithName("vertex_lines"),i=n.functionWithName("vertex_ground"),o=n.functionWithName("fragment_main"),a=n.functionWithName("bitonicSort"),n&&r&&i&&o&&a?((u=new WebGPURenderPipelineDescriptor).vertexFunction=r,u.fragmentFunction=o,u.colorAttachments[0].pixelFormat=80,u.depthAttachmentPixelFormat=252,this.linesRenderPipelineState=this.gpu.createRenderPipelineState(u),u.vertexFunction=i,this.groundRenderPipelineState=this.gpu.createRenderPipelineState(u),(c=new WebGPUDepthStencilDescriptor).depthCompareFunction="less",c.depthWriteEnabled=!0,this.depthStencilState=this.gpu.createDepthStencilState(c),this.renderPassDescriptor=new WebGPURenderPassDescriptor,(h=this.renderPassDescriptor.colorAttachments[0]).loadAction=2,h.storeAction=1,h.clearColor=[.1,.1,.2,1],(d=new WebGPUTextureDescriptor(252,t.CANVAS_WIDTH,t.CANVAS_HEIGHT,!1)).textureType=2,d.sampleCount=1,d.usage=0,d.storageMode=2,l=this.gpu.createTexture(d),(p=this.renderPassDescriptor.depthAttachment).loadAction=2,p.storeAction=1,p.clearDepth=1,p.texture=l,this.computePipelineState=this.gpu.createComputePipelineState(a),this.bitonicSortUniform=this.gpu.createBuffer(new Uint32Array([0,0])),this.bitonicSortUniformContents=new Uint32Array(this.bitonicSortUniform.contents),M=1<<t.MAX_SORT_MULTIPLIER+1,this.sortDataBuffer=this.gpu.createBuffer(new Float32Array(M)),this.sortData=new Float32Array(this.sortDataBuffer.contents),this.sortLength=1<<t.MIN_SORT_MULTIPLIER,this.resetData(this.sortData,this.sortLength),this.ground=new f(10,400,-120),this.ground.createBuffer(this.gpu),this.vertexUniform=new s,this.vertexUniform.createBuffer(this.gpu),this.vertexUniform.numLines=this.sortLength,this.camera=new ie(45*t.RAD,t.CANVAS_WIDTH/t.CANVAS_HEIGHT,.1,1e3),this.cameraController=new he(this.camera,this.canvas),this.canvas.style.cursor="move",this.cameraController.radius=250,this.cameraController.radiusOffset=2,this.cameraController.rotate(0,0),this.time=0,this.wave=0,this.sortStepCompleted=!1,this.vertexUniform.sortCompleteTime=Number.MAX_VALUE,this.render(),[2]):[2]}})})},t.prototype.render=function(){return fe(this,void 0,void 0,function(){var e,n,r,i,o,a,u,s,c=this;return de(this,function(h){switch(h.label){case 0:return this.stats.begin(),this.time+=1,this.wave+=1,this.cameraController.upDate(.1),e=this.camera.getCameraMtx(),n=this.commandQueue.createCommandBuffer(),!this.sortStepCompleted&&this.time>=60?(r=this.time-60)%(i=10)==0&&(this.sortStepCompleted=this.sortStep(this.sortDataBuffer,this.sortLength,n,r/i),this.sortStepCompleted&&(console.log("sort result validation: ",this.validateSorted(new Float32Array(this.sortDataBuffer.contents),this.sortLength)),this.time=0,this.vertexUniform.sortCompleteTime=this.wave)):this.sortStepCompleted&&this.time>=120&&(this.sortLength<1<<t.MAX_SORT_MULTIPLIER?this.sortLength*=2:this.sortLength=1<<t.MIN_SORT_MULTIPLIER,this.vertexUniform.numLines=this.sortLength,this.vertexUniform.sortCompleteTime=Number.MAX_VALUE,this.resetData(this.sortData,this.sortLength),this.time=0,this.sortStepCompleted=!1),o=this.gpu.nextDrawable(),this.renderPassDescriptor.colorAttachments[0].texture=o.texture,this.renderPassDescriptor.colorAttachments[0].loadAction=2,this.renderPassDescriptor.depthAttachment.loadAction=2,(a=n.createRenderCommandEncoderWithDescriptor(this.renderPassDescriptor)).setRenderPipelineState(this.linesRenderPipelineState),a.setDepthStencilState(this.depthStencilState),a.setVertexBuffer(this.sortDataBuffer,0,0),this.vertexUniform.mvpMatrix=e,this.vertexUniform.time=this.wave,a.setVertexBuffer(this.vertexUniform.buffer,0,1),a.drawPrimitives(1,0,2*this.sortLength),a.endEncoding(),this.renderPassDescriptor.colorAttachments[0].loadAction=1,this.renderPassDescriptor.depthAttachment.loadAction=1,(u=n.createRenderCommandEncoderWithDescriptor(this.renderPassDescriptor)).setRenderPipelineState(this.groundRenderPipelineState),u.setDepthStencilState(this.depthStencilState),u.setVertexBuffer(this.ground.vertexBuffer,0,0),u.setVertexBuffer(this.vertexUniform.buffer,0,1),u.drawPrimitives(1,0,this.ground.numVertices),u.endEncoding(),n.presentDrawable(o),s=n.completed,n.commit(),[4,s];case 1:return h.sent(),this.stats.end(),requestAnimationFrame(function(){return c.render()}),[2]}})})},t.prototype.sortStep=function(t,e,n,r){var i={width:Math.max(1,e/this.maxThreadNum),height:1,depth:1},o={width:Math.min(e,this.maxThreadNum),height:1,depth:1},a=!0,u=0;r+=1;for(var s=2;s<=e;s<<=1)for(var c=s>>1;c>0;c>>=1)if((u+=1)===r){var h=n.createComputeCommandEncoder();h.setComputePipelineState(this.computePipelineState),h.setBuffer(t,0,0),this.bitonicSortUniformContents[0]=s,this.bitonicSortUniformContents[1]=c,h.setBuffer(this.bitonicSortUniform,0,1),h.dispatch(i,o),h.endEncoding(),a=!1;break}return a},t.prototype.resetData=function(t,e){for(var n=0;n<e;n++)t[n]=200*(Math.random()-.5)},t.prototype.validateSorted=function(t,e){for(var n=e,r=0;r<n;r++)if(r!==n-1&&t[r]>t[r+1])return!1;return!0},t.MAX_THREAD_NUM_iOS=512,t.MAX_THREAD_NUM_macOS=1024,t.MIN_SORT_MULTIPLIER=3,t.MAX_SORT_MULTIPLIER=17,t.RAD=Math.PI/180,t.CANVAS_WIDTH=960,t.CANVAS_HEIGHT=540,t}();window.addEventListener("DOMContentLoaded",function(){new le})}]);